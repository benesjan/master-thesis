\chapter{Facial Recognition}\label{ch:face-rec}
Facial recognition is a task of verifying or identifying a person from digital image/video.

As I mentioned in the definition, there are two main subtasks~\cite{FaceRec}:
\begin{enumerate}
    \item \textbf{Verification} deals with verifying whether the person in the image is who he claims he is.
    Typical modern use case of verification is smartphone unlocking with face.
    An example of such system is Face ID developed by Apple Inc.

    \item \textbf{Identification} is a task of matching a person to an identity.
    To formulate it in another way, the goal of identification is to give us an answer to the question of who the person
    in the image is.
\end{enumerate}

\section{Pipeline}\label{sec:pipeline}

Facial recognition pipeline\footnote{\label{foot:pipe}A chain of processing elements, arranged so that the output of
each element is the input of the next.} usually has the following four steps:
\begin{enumerate}
    \item The first on is \textbf{face detection} and it deals with determination of face location within the image.
    The output of the algorithm is usually face coordinates and facial landmarks.
    Landmarks are a set of coordinates marking important points of the face (eyebrows, nose, mouth, \ldots).
    The knowledge of these points is a necessity for the following step.
    \item \textbf{Face alignment} is a task of changing the face position in such a way that it resembles the position
    of faces on which the feature extraction model was trained.
    In most of the instances this step improves the accuracy.
    \item \textbf{Feature extraction} is a process of computing a feature vector\footnote{A feature vector is a vector
    that contains information describing an object's important characteristics.} of the face.
    Architecture of models used for feature extraction is described in section~\ref{sec:mod-methods}.
    \item \textbf{Feature matching} uses feature vector from the previous task to identify the person in the image.
    The algorithm uses a database of pre-computed feature vectors and compares them to the newly extracted one.
    The identity associated with the feature vector which has the smallest distance from the extracted one is
    considered to be the identity of the person in the image.
\end{enumerate}

\section{Datasets}\label{sec:datasets}
In this section I will briefly describe datasets used for training and evaluation of facial recognition models.
There are too many different datasets used in practice.
For this reason I will focus only on those mentioned in this text.

\subsection{LFW}\label{subsec:lfw}
LFW is an acronym for Labeled Faces in the Wild.
The dataset contains 13,000 images and 1680 identities.
Every identity is represented by at least two samples.
The faces were detected by Viola-Jones face detector\footnote{Real-time object detection framework.}.

There are now four publicly used versions of the dataset.
These versions are differentiated by the type of preprocessing (different methods of alignment) applied to the images.

\subsection{YTF}\label{subsec:ytf}
YTF stands for YouTube Faces.
The data set contains 3425 videos and 1,595 unique identities.
The average length of the video clip is 181.3 frames and there are on average 2.15 videos for each subject.

\subsection{MS-Celeb-1M}\label{subsec:ms1m}
MS-Celeb-1M is a dataset constructed by Microsoft Research.
There are 10 million face images with nearly 100,000 individuals.
The data were harvested from the Internet.

Due to the method with which the images were collected there are many mislabellings in the dataset.
For this reason there are different versions available on the Internet containing refined data (like MS1MV2).

As the name implies the dataset contains images of celebrities.
In this context celebrity is assumed to be anyone with frequent online presence.
This became a controversial issue and as a result Microsoft pulled the dataset off the internet.

\section{Overview of Modern Methods}\label{sec:mod-methods}
In this section I am about to provide an overview of modern methods/models used for facial recognition.
Models based on CNN architecture~\ref{ch:cnn} achieve state-of-the-art results which is the reason why CNNs dominate the
field of facial recognition and the field of computer vision as a whole now.

Innovations made in the field of computer vision are usually applicable to the subfield of facial recognition as well.
This is manifested in usage of the same model architectures (ResNet~\ref{subsubsec:resnet},
InceptionNet~\ref{subsubsec:inceptionnet}, \ldots) in general image classification as well as in facial recognition.
On the other hand there is a lot of innovation going on in the design of loss functions which work especially well
when used for model training\footnote{Machine learning task of learning a function that maps an input to an output
based on example input-output pairs.} in facial recognition tasks.
This is the reason why this section is divided in two parts: \textit{models}~\ref{subsec:models} and
\textit{loss functions}~\ref{subsec:loss-functions}.

\include{chapters/face-recognition/models}
\include{chapters/face-recognition/losses}